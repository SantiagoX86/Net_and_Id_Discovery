# Identity Discovery Domain Specification

* **Organization:** WAUIG Bank
* **Project Name:** Enterprise Security Discovery Orchestration Framework
* **Document Version:** 1.2
* **Document Date:** 2026-02-20
* **Prepared By:** Sean Santiago (Developer / Security Engineer)
* **Project Manager:** Dana Whitlock (Project Manager)
* **Security Authority:** Chris Boseman (CISO)
* **Executive Sponsor:** Chad Hemsworth (CEO)

---

## 1. Purpose

The Identity Discovery Domain models identity-related exposure observable from an external or low-privilege vantage point. The domain operates in an agentless and non-exploitative manner, focusing strictly on identity information discoverable without credential misuse or privilege escalation. Its objective is to identify and structure findings related to exposed identity metadata, authentication surfaces, and trust indicators in a repeatable, auditable format. The domain integrates with the Core Framework to normalize findings and preserve consistency with existing discovery modules.

---

## 2. Vantage Point Assumptions

* No valid credentials are supplied.
* Discovery is executed from an external or minimally privileged network position.
* No exploitation, brute force, or authentication bypass techniques are used.
* Observations are limited to externally observable identity artifacts and protocol responses.

---

## 3. Scope

### 3.1 In Scope

* Detection of externally exposed authentication services (e.g., LDAP, Kerberos, WinRM, SMB authentication endpoints).
* Enumeration of domain naming information exposed via protocol negotiation.
* Identification of service principal naming indicators visible during connection handshakes.
* Observation of identity-relevant metadata disclosed during banner responses or protocol negotiation.
* Detection of externally reachable identity infrastructure components (e.g., Domain Controllers).

All findings must be passive or minimally interactive and must not alter target state.

### 3.2 Out of Scope

* Credential spraying or brute-force attempts.
* Anonymous or authenticated LDAP directory enumeration.
* Active exploitation of identity protocols.
* Privilege escalation or token manipulation.
* Lateral movement or session hijacking.
* Any modification to frozen M1–M3 components without formal change control.

---

## 4. Technical Approach

The Identity Discovery Domain extends the existing Core Framework module contract without introducing architectural changes to frozen Milestones M1–M3. The module operates using controlled TCP-based protocol interactions and minimal handshake-level inspection to identify identity-related metadata without authentication attempts or state modification. Where feasible, discovery logic reuses validated socket abstractions and error-handling patterns established in the Network Discovery Domain to preserve deterministic behavior.

Identity protocol detection relies on safe connection establishment and observation of server responses during initial negotiation phases (e.g., LDAP bind negotiation without credentials, SMB negotiation responses, Kerberos service availability checks). No credential material is transmitted. All interactions respect defined timeout thresholds and incorporate structured exception handling to prevent module failure propagation.

Findings are normalized through the existing finding schema and categorized according to approved identity-related categories. Confidence scoring reflects certainty based on protocol response quality (e.g., positive negotiation vs. connection reset). Errors, timeouts, or unexpected protocol behavior generate structured `module_error` or `identity_protocol_anomaly` events.

Implementation must be deterministic: identical environmental conditions must produce identical findings. No randomization, race conditions, or nondeterministic behavior will be introduced.

---

## 5. Implementation Phases

### Phase A – Module Scaffolding

* Create `Identity_Discovery_Domain.py` module.
* Implement required module interface.
* Integrate with orchestrator without functional logic.
* Validate failure isolation behavior.

### Phase B – Controlled Protocol Detection

* Implement minimal handshake-level service detection for identity-related protocols.
* Normalize findings into approved categories.
* Implement structured error handling and confidence scoring.

### Phase C – Regression Validation

* Execute full Network Discovery regression test.
* Confirm reporting output compatibility.
* Validate deterministic repeated execution behavior.

### Phase D – Documentation and Reporting

* Update Test Results Summary.
* Update Architecture documentation if required.
* Prepare milestone validation summary.

---

## 6. Acceptance Criteria

The Identity Discovery Domain will be considered complete when:

* Module executes without impacting Network Discovery.
* Findings conform to structured schema.
* No regression defects are introduced.
* Deterministic output is observed under identical conditions.
* Test Results Summary is updated and approved.

---

## 7. Regression Requirements

The following components must be revalidated upon completion:

* Core Framework orchestration behavior
* Network Discovery functionality
* Output Reporting module
* Exception isolation and structured event logging

All regression testing must be documented in the Test Results Summary.

---

## 8. Risk Assessment

| Risk                                   | Impact | Mitigation                                           |
| -------------------------------------- | ------ | ---------------------------------------------------- |
| Architectural regression               | High   | Strict adherence to module contract                  |
| Overly aggressive protocol interaction | Medium | Timeout enforcement and minimal handshake logic      |
| Non-deterministic output               | Medium | Controlled execution flow and deterministic ordering |
| Scope creep                            | Medium | Strict milestone boundary enforcement                |

---

## 9. Governance and Change Control

No modifications to frozen M1–M3 components are permitted without:

* Formal change documentation
* Re-execution of baseline regression tests
* Version increment and updated tag

All changes introduced under this domain must remain isolated unless formally authorized.

---

## 10. Identity Probe Strategy

The Identity Discovery Domain will employ a controlled, low-noise probing methodology designed to safely identify identity-related exposure without authentication attempts or target state modification. All probes must remain consistent with the agentless and non-exploitative design principles defined earlier in this specification.

### 10.1 Probe Design Principles

All identity probes must adhere to the following constraints:

* **Handshake-only interaction:** Probes will be limited to connection establishment and initial protocol negotiation where feasible.
* **No credential transmission:** The module must never send usernames, passwords, tokens, or authentication material.
* **Low-noise operation:** Timeouts and retry logic must minimize network noise and avoid triggering defensive controls.
* **Deterministic behavior:** Identical inputs and environmental conditions must yield identical outputs.
* **Failure isolation:** Probe failures must generate structured events without interrupting orchestrator execution.

### 10.2 Initial Protocol Targets

Phase B implementation currently includes the following validated probes, with additional protocols prioritized for future expansion:

#### Validated (Implemented in Phase B)
* SMB (TCP/445) — connectivity-only exposure signal; no negotiation/authentication
* WinRM (TCP/5985) — connectivity-only exposure signal; no HTTP request/authentication

#### Authorized Next (Phase B Expansion — Connectivity-Only)
* RPC Endpoint Mapper (TCP/135) — connect-only signal; no endpoint enumeration (no EPM queries)

#### Prioritized for Future Expansion (Requires Change Control)
* Kerberos (TCP/88)
* LDAP (TCP/389)
* LDAPS (TCP/636)
* WinRM over HTTPS (TCP/5986)

Protocol selection may expand in future milestones through formal change control.

### 10.3 Evidence Collection Strategy

A probe may generate a finding when one or more of the following conditions are observed:

* Successful TCP connection indicating service exposure.
* Protocol negotiation response consistent with identity infrastructure.
* Banner or metadata disclosure indicating domain or authentication context.

Evidence must remain strictly observational. The module must not attempt directory enumeration, authentication, or privilege testing.

### 10.4 Timeout and Safety Controls

To maintain enterprise-safe behavior:

* Default socket timeout must remain low (≤ 1–2 seconds).
* No aggressive retry loops are permitted in Phase B.
* Parallel probing must be avoided until explicitly authorized in a future milestone.
* All socket operations must be wrapped in structured exception handling.

### 10.5 Finding Classification Rules

Identity-related findings generated under this strategy will map to the approved categories defined earlier in this specification. Confidence scoring will reflect the strength of protocol confirmation (e.g., open port vs. verified service negotiation).

### 10.6 Future Expansion Guardrails

The following capabilities are explicitly deferred to later milestones and require formal review before implementation:

* Anonymous LDAP queries
* Kerberos pre-auth analysis
* SMB session metadata inspection beyond negotiation
* Any credential-based interaction

These guardrails ensure the Identity Discovery Domain remains aligned with the project’s non-exploitative mission.

---

## 11. Approval

This specification authorizes initiation of Milestone M4 – Identity Discovery implementation.

* **Developer Validation:** Sean Santiago
* **Project Review:** Dana Whitlock
* **Security Review:** Chris Boseman
* **Executive Acknowledgment:** Chad Hemsworth
